// jQuery isoSelective created by Alexander Buddy 'Gatsby' Jones http://www.gatsbyart.com
// update for jQuery 1.9+ by David Simmer http://simmerdesigns.com
function commonAncestor(e){var t=[];var n=Infinity;$(e).each(function(){var e=$(this).parents();t.push(e);n=Math.min(n,e.length)});for(var r in t){t[r]=t[r].slice(t[r].length-n)}for(var r in t[0]){var i=true;for(var s in t){if(t[s][r]!=t[0][r]){i=false;break}}if(i)return t[0][r]}return[]}(function(e){e.fn.isoSelective=function(t){var n=e.extend({},e.fn.isoSelective.defaults,t);return this.each(function(){$this=e(this);var t=e.meta?e.extend({},n,$this.data()):n;e.fn.isoSelective.initializeFiltering(t.linkSelector,t.attrSelector,t.activeClass,$this)})};e.fn.isoSelective.initializeFiltering=function(t,r,s,o){var u=o;var a=new Array;var f=e(t).length;var l=e(t).get(0).tagName;var c=commonAncestor(t);for(i=0;i<f;i++){if(e(c).find(l).eq(i).hasClass(s)){a[i]=e(c).find(l).eq(i).attr(r)+", "}else{a[i]=" "}}if(a.indexOf("*, ")!=-1){var h=a.indexOf("*, ");for(g=0;g<a.length;g++){a[g]=""}a[h]="*"}e(t).on("click",function(){var i=e(this).attr(r);var o=e(c).find(l).index(this);if(e(this).attr(r)!="*"){var h=a.indexOf("*");if(h!=-1){a[h]="";e(c).find(l).eq(h).toggleClass(s)}if(a[o]==e(this).attr(r)+", "){a[o]=""}else{a[o]=e(this).attr(r)+", "}e(this).toggleClass(s)}else{if(a[o]=="*, "||a[o]=="*"){a[o]="";e(t).removeClass(s)}else{for(n=0;n<f;n++){a[n]=""}a[o]="*";e(t).removeClass(s);e(this).addClass(s)}}var p=a.join("");var d=p.replace(/\s/g,"");if(d!="*"){d=d.slice(0,-1)}if(d==""){d="#nulldiviwthoutapropername"}e(u).isotope({filter:d});return false})};e.fn.isoSelective.defaults={linkSelector:".filter",attrSelector:"rel",activeClass:"selected"}})(jQuery)